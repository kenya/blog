<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>けんやのブログサイト</title><link rel="stylesheet" href="css.css" type="text/css"></head><body><div id="navi"><ul><li><a href="./index.php">けんやのブログ</a></li><li><a href="./post.php">記事を投稿</a></li><li><a href="http://www.kyoto-su.ac.jp">京都産業大学</a></li></ul></div><div id="body"><br><br><hr/><?php	try{		$dbh = new PDO('sqlite:blog.db','','');   //PDOクラスのオブジェクトの作成		$sth = $dbh->prepare("select * from posts order by date desc");   //prepareメソッドでSQL文の準備 新しい投稿が上に date descより		$sth->execute();   //準備したSQL文の実行				while ($row = $sth->fetch()) {				//テーブルの内容を１行ずつ処理			$time = preg_split("/[\s.:-]+/",$row['date']);			?><h3><?php echo $row['title'] ?></h3><p><?php echo $row['contents'] ?><br>(<?php echo $time[0]."年".$time[1]."月". $time[2]."日 ".$time[3].":".$time[4] ?>)</p><form action="edit.php" method="post"><p><input type="submit" value="編集"><input type="hidden" name="id" value="<?php echo $row['id']?>"></p></form><form action="delete.php" method="post"><p><input type="submit" value="削除" />パスワード:<input type="password" name="password" size="20" /><input type="hidden" name="id" value="<?php echo $row['id']?>"/></p></form><h3>コメント</h3><br><?php	try{		$dbh2 = new PDO('sqlite:blog.db','','');   //PDOクラスのオブジェクトの作成		$sth2 = $dbh2->prepare("select * from comments order by date desc");   //prepareメソッドでSQL文の準備 新しい投稿が上に date descより		$sth2->execute();   //準備したSQL文の実行		while($row2 = $sth2->fetch()){			$time2 = preg_split("/[\s.:-]+/",$row2['date']);			?><p>	<?php		if($row['id'] == $row2['pid']){		echo "ID: ".$row2['id']."<br>";				//echo $row2['pid'];		echo "コメント:".$row2['contents'];		?>	<?php	 echo "(".$time2[0]."年".$time2[1]."月". $time2[2]."日 ".$time2[3].":".$time2[4].")";		echo "<br>";	 }	 ?></p>	<?php		}		} Catch (PDOException $e) {			print "エラー!: " . $e->getMessage() . "<br/>";			die();		}		?><form action="comments.php" method="post"><p>	<textarea name="contents" rows="2" cols="50" placeholder="コメント入力欄"></textarea>	<input type="hidden" name="pid" value="<?php echo $row['id'] ?>">	<input type="submit" value="投稿"></p></form><hr/><?php	}	} Catch (PDOException $e) {		print "エラー!: " . $e->getMessage() . "<br/>";		die();	}	?></div><footer><p>Copyright (C) 2014 g1244587. All Rights Reserved.</p></footer></body></html>